<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="Ferramentas e materiais da Guarin√≠ e-sport: calculadoras e utilit√°rios para jogadores." />
  <title>Materiais Guarin√≠ e-sport</title>
  <link rel="icon" href="favicon.png" type="image/png" />
  <link rel="stylesheet" href="style.css" />
  <link rel="stylesheet" href="materiais.css" />
  <style>
    .ferramentas {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 20px;
      background-color: rgba(0, 0, 0, 0.6);
      padding: 20px;
      border-radius: 10px;
      max-width: 900px;
      margin: auto;
    }

    .ferramenta {
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      height: 100%;
    }

    .ferramenta .descricao {
      flex-grow: 1;
      display: flex;
      align-items: center;
    }

    @media (max-width: 768px) {
      .ferramentas {
        grid-template-columns: 1fr;
      }
    }

    @media (min-width: 769px) and (max-width: 1024px) {
      .ferramentas {
        grid-template-columns: repeat(2, 1fr);
      }
    }
  </style>
<!-- Adsense tag -->
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4262085354518962"
     crossorigin="anonymous"></script>
</head>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-84NHN394WF"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-84NHN394WF');
</script>
<body>
  <a id="topo"></a>
  
  <header>
    <div class="header-wrapper">
      <!-- Navega√ß√£o Desktop - Esquerda -->
      <nav class="nav-group left-nav">
        <ul>
          <li><a href="loja.html">Loja</a></li>
          <li><a href="sobre.html">Sobre</a></li>
        </ul>
      </nav>
      
      <!-- Logo Central -->
      <div class="logo-center">
        <a href="index.html" aria-label="In√≠cio">
          <img src="./logos/Guarini.png" alt="Guarin√≠ e-sport" class="header-logo">
        </a>
      </div>

      <!-- Navega√ß√£o Desktop - Direita -->
      <nav class="nav-group right-nav">
        <ul>
          <li><a href="equipes.html">Times</a></li>
          <li><a href="material.html" class="ativo">Material</a></li>
        </ul>
      </nav>
      
      <!-- Bot√£o Menu Mobile -->
      <button class="menu-toggle" aria-label="Menu">
        <span></span>
        <span></span>
        <span></span>
      </button>
      
      <!-- Menu Mobile -->
      <nav class="mobile-menu">
        <ul>
          <li><a href="index.html">In√≠cio</a></li>
          <li><a href="sobre.html">Sobre</a></li>
          <li><a href="equipes.html">Times</a></li>
          <li><a href="loja.html">Loja</a></li>
          <li><a href="material.html" class="ativo">Material</a></li>
          <li><a href="contato.html">Contato</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <div class="user-container">
    <button class="btn-login-topo" id="loginLogoutBtn">Login</button>
    <div class="user-info" id="userInfo">
      Ol√°, <span id="userName"></span>!
    </div>
  </div>

  <main>
    <h2>Ferramentas</h2>
    <section class="ferramentas">
      
      <!-- Calculadora de Performance -->
      <article class="ferramenta">
        <img src="./img-site/calculadora.png" alt="Calculadora de Performance">
        <h3>Calculadora de Performance</h3>
        <p class="descricao">Calcule suas estat√≠sticas de jogo e compare com outros jogadores</p>
        <button type="button" class="btn-comprar" id="calcBtn">Acessar</button>
        <div id="calcAccessMessage" style="color: red; margin-top: 10px; display: none;"></div>
      </article>

      <!-- Estat√≠sticas do Time -->
      <article class="ferramenta">
        <img src="./img-site/grafico.png" alt="Estat√≠sticas" />
        <h3>Estat√≠sticas do time</h3>
        <p class="descricao">Veja seu perfil com seus e os n√∫meros da sua equipe</p>
        <button type="button" class="btn-comprar" id="statBtn">Acessar</button>
        <div id="statAccessMessage" style="color: red; margin-top: 10px; display: none;"></div>
      </article>

      <!-- Calculadora de Winrate Ranqueado -->
      <article class="ferramenta">
        <img src="./img-site/winrate.png" alt="Calculadora de Winrate Ranqueado" />
        <h3>Calculadora de Winrate Ranqueado</h3>
        <p class="descricao">Calcule seu winrate espec√≠fico de Rankeds ou qualquer outro tipo de partida</p>
        <button type="button" class="btn-comprar" id="winrateBtn">Acessar</button>
        <div id="calcWinrateMessage" style="color: red; margin-top: 10px; display: none;"></div>
      </article>

      <!-- An√°lise de Equipe -->
      <article class="ferramenta">
        <img src="./img-site/avalia√ßao.png" alt="An√°lise de Equipe" />
        <h3>An√°lise de Equipe</h3>
        <p class="descricao">Organize e analise os pontos fortes e fracos da sua equipe</p>
        <button type="button" class="btn-comprar" id="analiseBtn">Acessar</button>
        <div id="analiseAccessMessage" style="color: red; margin-top: 10px; display: none;"></div>
      </article>

      <!-- Build Maker -->
      <article class="ferramenta">
        <img src="./img-site/buildmaker.png" alt="Build Maker" />
        <h3>Build Maker</h3>
        <p class="descricao">Crie e otimize suas builds com calculadora de dano integrada</p>
        <button type="button" class="btn-comprar" id="buildBtn">Acessar</button>
        <div id="buildAccessMessage" style="color: red; margin-top: 10px; display: none;"></div>
      </article>

      <!-- Slot vazio para futura ferramenta -->
      <article class="ferramenta" style="opacity: 0.3;">
        <img src="./img-site/embreve.png" alt="Em Breve" />
        <h3>Em Breve</h3>
        <p class="descricao">Nova ferramenta ser√° adicionada aqui</p>
        <button type="button" class="btn-comprar" disabled>Em Breve</button>
      </article>

    </section>

    <p style="text-align:center; margin-top: 2rem;">
      <a href="index.html" class="btn-comprar">Voltar para In√≠cio</a>
    </p>
  </main>

<footer>
  <div class="footer-content">
    <!-- Bot√µes de a√ß√£o no footer -->
    <div class="footer-actions">
      <!-- Bot√£o de instalar app -->
      <button id="installBtn" class="btn-install">üì± Instalar Guarini</button>
      
      <!-- Seletor de idioma customizado -->
      <div class="language-selector">
        <button class="language-btn" id="languageBtn">
          <span class="flag flag-br"></span>
          <span id="currentLang">Portugu√™s</span>
          <span>‚ñº</span>
        </button>
        <div class="language-dropdown" id="languageDropdown">
          <div class="language-option" data-lang="pt" data-flag="flag-br" data-name="Portugu√™s">
            <span class="flag flag-br"></span>
            <span>Portugu√™s</span>
          </div>
          <div class="language-option" data-lang="en" data-flag="flag-us" data-name="English">
            <span class="flag flag-us"></span>
            <span>English</span>
          </div>
          <div class="language-option" data-lang="ja" data-flag="flag-jp" data-name="Êó•Êú¨Ë™û">
            <span class="flag flag-jp"></span>
            <span>Êó•Êú¨Ë™û</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Informa√ß√µes do footer -->
    <div class="footer-info">
      <p>&copy; 2019 Guarini e-sport. Todos os direitos reservados.</p>
      <p><a href="https://linktr.ee/guariniesports" target="_blank">Conhe√ßa nossas redes sociais</a></p>
      <p>Created by: Lobo & Shad</p>
    </div>
  </div>
</footer>


  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
    import { 
      getAuth, 
      onAuthStateChanged, 
      signOut 
    } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
    import { 
      getFirestore, 
      doc, 
      getDoc, 
      setDoc 
    } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyC9LLCXrQTHBagQxaChBazSfS5E4gUPIoI",
      authDomain: "site-grn.firebaseapp.com",
      projectId: "site-grn",
      storageBucket: "site-grn.firebasestorage.app",
      messagingSenderId: "27613322806",
      appId: "1:27613322806:web:ad4dc08ce043f19d530297",
      measurementId: "G-84NHN394WF"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    const loginLogoutBtn = document.getElementById("loginLogoutBtn");
    const userInfo = document.getElementById('userInfo');
    const userName = document.getElementById("userName");
    const calcBtn = document.getElementById("calcBtn");
    const statBtn = document.getElementById("statBtn");
    const winrateBtn = document.getElementById("winrateBtn");
    const analiseBtn = document.getElementById("analiseBtn");
    const buildBtn = document.getElementById("buildBtn");
    const calcAccessMessage = document.getElementById("calcAccessMessage");
    const statAccessMessage = document.getElementById("statAccessMessage");
    const calcWinrateMessage = document.getElementById("calcWinrateMessage");
    const analiseAccessMessage = document.getElementById("analiseAccessMessage");
    const buildAccessMessage = document.getElementById("buildAccessMessage");

    // Fun√ß√£o para lidar com login
    async function handleLogin() {
      try {
        sessionStorage.setItem('redirectAfterLogin', 'material.html');
        window.location.href = 'login.html';
      } catch (err) {
        console.error("Erro ao redirecionar para login:", err);
        alert('Erro ao tentar fazer login. Por favor, tente novamente.');
      }
    }

    // Fun√ß√£o para lidar com logout
    async function handleLogout() {
      try {
        await signOut(auth);
      } catch (error) {
        console.error("Erro no logout:", error);
        alert('Erro ao fazer logout. Tente novamente.');
      }
    }

    // Atualiza a UI baseada no estado de autentica√ß√£o
    function updateUI(user) {
      if (user) {
        loginLogoutBtn.textContent = 'Logout';
        loginLogoutBtn.onclick = handleLogout;
        
        const displayName = user.displayName || user.email.split('@')[0];
        userName.textContent = displayName;
        userInfo.style.display = 'block';
      } else {
        loginLogoutBtn.textContent = 'Login';
        loginLogoutBtn.onclick = handleLogin;
        userInfo.style.display = 'none';
      }
    }

    // Configura acesso √† calculadora de performance (sempre liberado)
    function setupCalculatorAccess() {
      calcBtn.onclick = () => window.location.href = 'desempenho.html';
      calcAccessMessage.style.display = 'none';
    }

    // Configura acesso √† calculadora de winrate (sempre liberado)
    function setupWinrateAccess() {
      winrateBtn.onclick = () => window.location.href = 'ferramenta-cenario.html';
      calcWinrateMessage.style.display = 'none';
    }

    // Configura acesso √† an√°lise de equipe (sempre liberado)
    function setupAnaliseAccess() {
      analiseBtn.onclick = () => window.location.href = 'avalia√ßaopontos.html';
      analiseAccessMessage.style.display = 'none';
    }

    // Configura acesso ao Build Maker (sempre liberado)
    function setupBuildAccess() {
      buildBtn.onclick = () => window.location.href = 'damage-calculator.html';
      buildAccessMessage.style.display = 'none';
    }

    // Verifica permiss√µes do usu√°rio para estat√≠sticas
    async function checkStatsPermissions(user) {
      if (!user) {
        setupRestrictedStatsAccess("Fa√ßa login para acessar esta ferramenta");
        return;
      }

      try {
        const docRef = doc(db, "usuarios", user.uid);
        const docSnap = await getDoc(docRef);

        if (docSnap.exists()) {
          const userData = docSnap.data();
          
          if (userData.role === 'player' || userData.role === 'admin') {
            statBtn.onclick = () => window.location.href = './estatisticas-shad/indexStat.html';
            statAccessMessage.style.display = 'none';
          } else {
            setupRestrictedStatsAccess("Voc√™ n√£o tem permiss√£o para usar essa ferramenta");
          }
        } else {
          await setDoc(doc(db, "usuarios", user.uid), {
            email: user.email,
            role: 'user',
            createdAt: new Date()
          });
          setupRestrictedStatsAccess("Voc√™ n√£o tem permiss√£o para usar essa ferramenta");
        }
      } catch (error) {
        console.error("Erro ao verificar permiss√µes:", error);
        setupRestrictedStatsAccess("Erro ao verificar permiss√µes. Tente novamente.");
      }
    }

    function setupRestrictedStatsAccess(message) {
      statBtn.onclick = () => {
        statAccessMessage.textContent = message;
        statAccessMessage.style.display = 'block';
        setTimeout(() => {
          statAccessMessage.style.display = 'none';
        }, 3000);
      };
    }

    // Monitora estado de autentica√ß√£o
    onAuthStateChanged(auth, async (user) => {
      updateUI(user);
      
      setupCalculatorAccess();
      setupWinrateAccess();
      setupAnaliseAccess();
      setupBuildAccess();
      
      await checkStatsPermissions(user);
    });

    // Funcionalidade do menu mobile
    const menuToggle = document.querySelector('.menu-toggle');
    const mobileMenu = document.querySelector('.mobile-menu');

    menuToggle.addEventListener('click', function() {
      this.classList.toggle('ativo');
      mobileMenu.classList.toggle('ativo');
    });

    const mobileLinks = document.querySelectorAll('.mobile-menu a');
    mobileLinks.forEach(link => {
      link.addEventListener('click', function() {
        menuToggle.classList.remove('ativo');
        mobileMenu.classList.remove('ativo');
      });
    });

    window.addEventListener('resize', function() {
      if (window.innerWidth > 900) {
        menuToggle.classList.remove('ativo');
        mobileMenu.classList.remove('ativo');
      }
    });
  </script>
  <script>
  // PWA - Bot√£o de instala√ß√£o
  let deferredPrompt;
  window.addEventListener('beforeinstallprompt', (e) => {
    e.preventDefault();
    deferredPrompt = e;
    document.getElementById('installBtn').style.display = 'block';
  });

  document.getElementById('installBtn').addEventListener('click', async () => {
    if (!deferredPrompt) return;
    deferredPrompt.prompt();
    const { outcome } = await deferredPrompt.userChoice;
    deferredPrompt = null;
    document.getElementById('installBtn').style.display = 'none';
    console.log('Usu√°rio respondeu:', outcome);
  });

  // Seletor de idioma customizado
  const languageBtn = document.getElementById('languageBtn');
  const languageDropdown = document.getElementById('languageDropdown');
  const currentLang = document.getElementById('currentLang');
  const languageOptions = document.querySelectorAll('.language-option');

  languageBtn.addEventListener('click', function(e) {
    e.stopPropagation();
    languageDropdown.classList.toggle('show');
  });

  document.addEventListener('click', function(e) {
    if (!languageBtn.contains(e.target)) {
      languageDropdown.classList.remove('show');
    }
  });

  languageOptions.forEach(option => {
    option.addEventListener('click', function() {
      const lang = this.dataset.lang;
      const flag = this.dataset.flag;
      const name = this.dataset.name;
      
      const flagElement = languageBtn.querySelector('.flag');
      flagElement.className = `flag ${flag}`;
      currentLang.textContent = name;
      languageDropdown.classList.remove('show');
      
      const translateElement = document.querySelector('.goog-te-combo');
      if (translateElement) {
        translateElement.value = lang;
        translateElement.dispatchEvent(new Event('change'));
      } else {
        setTimeout(() => {
          const translateElement = document.querySelector('.goog-te-combo');
          if (translateElement) {
            translateElement.value = lang;
            translateElement.dispatchEvent(new Event('change'));
          }
        }, 1000);
      }
    });
  });
</script>

</body>
</html>