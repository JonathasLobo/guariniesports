<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Login Firebase</title>
<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Login Firebase</title>
<style>
  :root{
    --accent:#ff7500;
    --accent-2:#ffad00;
  }
  html,body{height:100%;}
  body {
    font-family: Arial, sans-serif;
    background: url('background.jpg') no-repeat center center fixed;
    background-size: cover;
    margin: 0;
    min-height: 100vh;
    display: flex;
    align-items: center;
    justify-content: center;
    padding-bottom: 120px; /* espaÃ§o para footer */
    box-sizing: border-box;
  }
  .container {
    background: white;
    padding: 20px;
    border-radius: 10px;
    box-shadow: 0px 4px 12px rgba(0,0,0,0.2);
    width: 300px;
    text-align: center;
  }
  h2 { margin-bottom: 15px; color: #333; }
  input, button {
    width: 100%;
    padding: 9px;
    margin: 6px 0;
    border-radius: 6px;
    border: 1px solid #ccc;
    font-size: 14px;
    box-sizing: border-box;
  }
  button {
    border: none;
    background-color: var(--accent);
    color: white;
    cursor: pointer;
    transition: background-color 0.3s;
  }
  button:hover { background-color: var(--accent-2); }
  button:disabled { background-color: #ccc; cursor: not-allowed; }
  .error-message { color: #ff0000; font-size: 12px; margin: 5px 0; display: none; }
  .success-message { color: #00aa00; font-size: 12px; margin: 5px 0; display: none; }
  .loading { display: none; color: #666; font-size: 12px; margin: 5px 0; }
  .divider { margin: 12px 0; border-bottom: 1px solid #eee; position: relative; }
  .divider::after {
    content: "ou";
    position: absolute;
    bottom: -9px;
    left: 50%;
    transform: translateX(-50%);
    background: white;
    padding: 0 8px;
    color: #666;
    font-size: 12px;
  }

  footer{
    position: fixed;
    left: 0;
    bottom: 0;
    width: 100%;
    background: rgba(0,0,0,0.94);
    color: #fff;
    border-top: 2px solid var(--accent);
    padding: 8px 6px;
    box-sizing: border-box;
    z-index: 9999;
  }
  .footer-content{
    max-width: 900px;
    margin: 0 auto;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 6px;
  }
  .footer-actions{
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 6px;
    width: 100%;
  }
  .btn-install{
    background: linear-gradient(45deg, var(--accent), var(--accent-2));
    color: #000;
    padding: 8px 14px;
    border-radius: 6px;
    font-weight: 700;
    border: none;
    cursor: pointer;
    min-width: 180px;
    font-size: 13px;
  }
  .btn-install:hover{ transform: translateY(-1px); }
  .language-selector{ position: relative; display: inline-block; }
  .language-btn{
    background: transparent;
    color: #fff;
    padding: 8px 12px;
    border-radius: 6px;
    border: 1px solid rgba(255,255,255,0.1);
    cursor: pointer;
    font-weight: 600;
    min-width: 180px;
    font-size: 13px;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 6px;
  }
  .language-btn:hover{ background: rgba(255,255,255,0.05); }
  .language-dropdown{
    display: none;
    position: absolute;
    bottom: calc(100% + 6px);
    left: 50%;
    transform: translateX(-50%);
    background: rgba(0,0,0,0.96);
    border-radius: 6px;
    padding: 6px 4px;
    min-width: 160px;
    z-index: 10000;
  }
  .language-dropdown.show{ display: block; }
  .language-option{
    padding: 6px 10px;
    color: #fff;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 6px;
    border-radius: 5px;
    font-size: 13px;
  }
  .language-option:hover{ background: rgba(255,173,0,0.08); }
  .flag{ display:inline-block; width:18px; height:12px; background-size: cover; border-radius:3px; }
  .flag-br{ background-image: url('https://flagcdn.com/w20/br.png'); }
  .flag-us{ background-image: url('https://flagcdn.com/w20/us.png'); }
  .flag-jp{ background-image: url('https://flagcdn.com/w20/jp.png'); }
  .footer-info{ text-align:center; font-size:0.8rem; opacity:0.8; }
</style>
<div id="google_translate_element" style="display:none"></div>

<script type="text/javascript">
function googleTranslateElementInit() {
  new google.translate.TranslateElement(
    {pageLanguage: 'pt', includedLanguages: 'pt,en,ja'},
    'google_translate_element'
  );
}
</script>

<script type="text/javascript" src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>
<!-- Adsense tag -->
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4262085354518962"
     crossorigin="anonymous"></script>
</head>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-84NHN394WF"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);} 
  gtag('js', new Date());
  gtag('config', 'G-84NHN394WF');
</script>
<body>
<div class="container" role="main">
  <h2>Login</h2>
  
  <div class="error-message" id="errorMessage"></div>
  <div class="success-message" id="successMessage"></div>
  <div class="loading" id="loadingMessage">Carregando...</div>
  
  <input type="email" id="email" placeholder="Digite seu email" required>
  <input type="password" id="senha" placeholder="Digite sua senha" required>
  
  <button id="btnLogin">Entrar</button>
  
  <div class="divider" aria-hidden="true"></div>
  
  <button id="btnGoogle">Entrar com Google</button>
  
  <div style="margin-top: 14px;">
    <p style="font-size: 12px; color: #666; margin:0;">
      NÃ£o tem uma conta? 
      <button id="btnRegistrar" style="background: none; border: none; color: var(--accent); cursor: pointer; text-decoration: underline; padding: 0; font-size: 12px;">
        Criar conta
      </button>
    </p>
  </div>
</div>

<!-- RODAPÃ‰ PADRONIZADO (botÃµes empilhados abaixo) -->
<footer>
  <div class="footer-content">
    <div class="footer-actions" role="group" aria-label="AÃ§Ãµes do rodapÃ©">
      <button id="installBtn" class="btn-install" aria-label="Instalar aplicativo">ðŸ“± Instalar Guarini</button>

      <div class="language-selector" id="langSel">
        <button class="language-btn" id="languageBtn" aria-haspopup="true" aria-expanded="false">
          <span class="flag flag-br" aria-hidden="true"></span>
          <span id="currentLang">PortuguÃªs</span>
          <span aria-hidden="true">â–¼</span>
        </button>
        <div class="language-dropdown" id="languageDropdown" role="menu" aria-hidden="true">
          <div class="language-option" data-lang="pt" data-flag="flag-br" data-name="PortuguÃªs" role="menuitem">
            <span class="flag flag-br" aria-hidden="true"></span>
            <span>PortuguÃªs</span>
          </div>
          <div class="language-option" data-lang="en" data-flag="flag-us" data-name="English" role="menuitem">
            <span class="flag flag-us" aria-hidden="true"></span>
            <span>English</span>
          </div>
          <div class="language-option" data-lang="ja" data-flag="flag-jp" data-name="æ—¥æœ¬èªž" role="menuitem">
            <span class="flag flag-jp" aria-hidden="true"></span>
            <span>æ—¥æœ¬èªž</span>
          </div>
        </div>
      </div>
    </div>

    <div class="footer-info">
      <p>&copy; 2019 GuarinÃ­ e-sport. Todos os direitos reservados.</p>
      <p><a href="https://linktr.ee/guariniesports" target="_blank" rel="noopener noreferrer" style="color:var(--accent);">ConheÃ§a nossas redes sociais</a></p>
      <p>Created by: Lobo & Shad</p>
    </div>
  </div>
</footer>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-app.js";
  import { 
    getAuth, 
    signInWithEmailAndPassword, 
    GoogleAuthProvider, 
    signInWithPopup,
    onAuthStateChanged 
  } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-auth.js";

  const firebaseConfig = {
    apiKey: "AIzaSyC9LLCXrQTHBagQxaChBazSfS5E4gUPIoI",
    authDomain: "site-grn.firebaseapp.com",
    projectId: "site-grn",
    storageBucket: "site-grn.firebasestorage.app",
    messagingSenderId: "27613322806",
    appId: "1:27613322806:web:ad4dc08ce043f19d530297",
    measurementId: "G-84NHN394WF"
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);

  // ConfiguraÃ§Ã£o do Google Provider
  const provider = new GoogleAuthProvider();
  provider.addScope('email');
  provider.addScope('profile');
  provider.setCustomParameters({ prompt: 'select_account' });

  // Elementos do DOM
  const email = document.getElementById("email");
  const senha = document.getElementById("senha");
  const btnLogin = document.getElementById("btnLogin");
  const btnGoogle = document.getElementById("btnGoogle");
  const btnRegistrar = document.getElementById("btnRegistrar");
  const errorMessage = document.getElementById("errorMessage");
  const successMessage = document.getElementById("successMessage");
  const loadingMessage = document.getElementById("loadingMessage");

  function showMessage(element, message, duration = 5000) {
    element.textContent = message;
    element.style.display = "block";
    setTimeout(() => { element.style.display = "none"; }, duration);
  }

  function hideAllMessages() {
    errorMessage.style.display = "none";
    successMessage.style.display = "none";
    loadingMessage.style.display = "none";
  }

  function setLoading(isLoading) {
    btnLogin.disabled = isLoading;
    btnGoogle.disabled = isLoading;
    if (isLoading) loadingMessage.style.display = "block"; else loadingMessage.style.display = "none";
  }

  async function signInWithGoogle() {
    try {
      const result = await signInWithPopup(auth, provider);
      return result;
    } catch (error) {
      console.error("Erro do Google:", error);
      throw error;
    }
  }

  function getErrorMessage(errorCode) {
    switch (errorCode) {
      case 'auth/user-not-found': return 'UsuÃ¡rio nÃ£o encontrado. Verifique o email ou crie uma conta.';
      case 'auth/wrong-password': return 'Senha incorreta. Tente novamente.';
      case 'auth/invalid-email': return 'Email invÃ¡lido. Verifique o formato do email.';
      case 'auth/too-many-requests': return 'Muitas tentativas de login. Tente novamente mais tarde.';
      case 'auth/network-request-failed': return 'Erro de conexÃ£o. Verifique sua internet.';
      case 'auth/invalid-credential': return 'Email ou senha incorretos.';
      case 'auth/popup-closed-by-user': return 'Login cancelado pelo usuÃ¡rio.';
      case 'auth/popup-blocked': return 'Popup bloqueado pelo navegador. Permita popups para este site.';
      default: return `Erro no login: ${errorCode}. Tente novamente.`;
    }
  }

  onAuthStateChanged(auth, (user) => {
    if (user) window.location.href = "index.html";
  });

  btnLogin.addEventListener("click", async () => {
    hideAllMessages();
    const emailValue = email.value.trim();
    const senhaValue = senha.value;
    if (!emailValue || !senhaValue) { showMessage(errorMessage, "Por favor, preencha todos os campos."); return; }
    if (!emailValue.includes("@")) { showMessage(errorMessage, "Por favor, digite um email vÃ¡lido."); return; }
    setLoading(true);
    try { await signInWithEmailAndPassword(auth, emailValue, senhaValue); showMessage(successMessage, "Login realizado com sucesso!"); setTimeout(()=> window.location.href = "index.html", 800); }
    catch (error) { console.error(error); showMessage(errorMessage, getErrorMessage(error.code)); }
    finally { setLoading(false); }
  });

  btnGoogle.addEventListener("click", async () => {
    hideAllMessages(); setLoading(true);
    try { await signInWithGoogle(); showMessage(successMessage, "Login com Google realizado com sucesso!"); setTimeout(()=> window.location.href = "index.html", 800); }
    catch (error) { console.error(error); if (error.code === 'auth/popup-closed-by-user') showMessage(errorMessage, "Login cancelado. Tente novamente."); else if (error.code === 'auth/popup-blocked') showMessage(errorMessage, "Popup bloqueado. Permita popups neste site."); else showMessage(errorMessage, getErrorMessage(error.code)); }
    finally { setLoading(false); }
  });

  btnRegistrar.addEventListener("click", () => window.location.href = "registro.html");

  document.addEventListener("keypress", (e) => { if (e.key === "Enter" && !btnLogin.disabled) btnLogin.click(); });

</script>

<script>
  /* PWA - BotÃ£o de instalaÃ§Ã£o + seletor de idioma */
  (function(){
    let deferredPrompt = null;
    const installBtn = document.getElementById('installBtn');
    const languageBtn = document.getElementById('languageBtn');
    const languageDropdown = document.getElementById('languageDropdown');
    const currentLang = document.getElementById('currentLang');
    const languageOptions = document.querySelectorAll('.language-option');

    window.addEventListener('beforeinstallprompt', (e) => {
      e.preventDefault();
      deferredPrompt = e;
      if (installBtn) installBtn.style.display = 'inline-flex';
    });

    if (installBtn) {
      installBtn.addEventListener('click', async () => {
        if (!deferredPrompt) return;
        deferredPrompt.prompt();
        const { outcome } = await deferredPrompt.userChoice;
        deferredPrompt = null;
        installBtn.style.display = 'none';
        console.log('UsuÃ¡rio respondeu:', outcome);
      });
    }

    // Toggle dropdown
    if (languageBtn) {
      languageBtn.addEventListener('click', function(e){
        e.stopPropagation();
        const isOpen = languageDropdown.classList.toggle('show');
        languageBtn.setAttribute('aria-expanded', isOpen ? 'true' : 'false');
        languageDropdown.setAttribute('aria-hidden', isOpen ? 'false' : 'true');
      });
    }

    document.addEventListener('click', function(e){
      if (!languageBtn.contains(e.target)) {
        languageDropdown.classList.remove('show');
        languageBtn.setAttribute('aria-expanded','false');
        languageDropdown.setAttribute('aria-hidden','true');
      }
    });

    languageOptions.forEach(option => {
      option.addEventListener('click', function(){
        const lang = this.dataset.lang;
        const flag = this.dataset.flag;
        const name = this.dataset.name;
        const flagElement = languageBtn.querySelector('.flag');
        flagElement.className = 'flag ' + flag;
        currentLang.textContent = name;
        languageDropdown.classList.remove('show');
        languageBtn.setAttribute('aria-expanded','false');
        languageDropdown.setAttribute('aria-hidden','true');

        // Tenta usar o seletor do Google Translate (se existir)
        const translateElement = document.querySelector('.goog-te-combo');
        if (translateElement) {
          translateElement.value = lang;
          translateElement.dispatchEvent(new Event('change'));
        } else {
          setTimeout(() => {
            const translateElement2 = document.querySelector('.goog-te-combo');
            if (translateElement2) { translateElement2.value = lang; translateElement2.dispatchEvent(new Event('change')); }
          }, 800);
        }
      });
    });
  })();
</script>

</body>
</html>
