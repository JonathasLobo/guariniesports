<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Site oficial da equipe Guarini e-sport">
  <title>Guarini e-sport</title>
  <link rel="icon" href="./img-site/favicon.png" type="image/png">
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="./videos/videos.css">
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#ffad00">
  <!-- iOS meta tags -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <link rel="apple-touch-icon" href="/icons/icon-192.png">

  <!-- Adsense tag -->
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4262085354518962"
       crossorigin="anonymous"></script>

  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-84NHN394WF"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-84NHN394WF');
  </script>
</head>

<body>
  <a id="topo"></a>

  <header>
    <div class="header-wrapper">
      <!-- Navega√ß√£o Desktop - Esquerda -->
      <nav class="nav-group left-nav">
        <ul>
          <li><a href="./loja/loja.html">Shop</a></li>
          <li><a href="./sobre/sobre.html">About</a></li>
        </ul>
      </nav>
      
      <!-- Logo Central -->
      <div class="logo-center">
        <a href="index.html" aria-label="In√≠cio" class="ativo">
          <img src="./img-site/grn-logo.png" alt="Guarini e-sport" class="header-logo">
        </a>
      </div>

      <!-- Navega√ß√£o Desktop - Direita -->
      <nav class="nav-group right-nav">
        <ul>
          <li><a href="./groups/groups.html">Games</a></li>
          <li><a href="./contato/contato.html">Contact</a></li>
        </ul>
      </nav>
    
    </div>
  </header>

  <!-- Menu dropdown do usu√°rio -->
  <div class="user-menu-container">
    <button class="user-menu-toggle" id="userMenuToggle" aria-label="Menu do usu√°rio">
      <span></span>
      <span></span>
      <span></span>
    </button>
    
    <div class="user-dropdown" id="userDropdown">
      <div class="user-dropdown-header" id="userDropdownHeader">
        <span>Hello, visitor!</span>
      </div>
      <ul class="user-dropdown-list">
        <li><a href="./perfil/perfil.html" id="perfilLink">Profile</a></li>
        <li><a href="./loja/loja.html">Shop</a></li>
        <li><a href="./sobre/sobre.html">About</a></li>
        <li><a href="./groups/groups.html">Games</a></li>
        <li><a href="./contato/contato.html">Contact</a></li>
        <li><a href="#" id="authLink">Login</a></li>
      </ul>
    </div>
  </div>

  <!-- Barra de busca de perfis -->
  <div class="profile-search-container">
    <div class="profile-search-wrapper">
      <input 
        type="text" 
        id="profileSearchInput" 
        class="profile-search-input" 
        placeholder="Search Player ID..."
        maxlength="7"
      >
      <button class="profile-search-btn" id="profileSearchBtn" title="Search Profile">
        üîç
      </button>
    </div>
    <div class="profile-search-results" id="profileSearchResults"></div>
  </div>

  <main>
    <section id="home" class="hero">
      <div class="hero-image">
        <img src="./img-site/what makes you strenght.png" alt="What makes you strenght - Guarini e-sport">
      </div>
      <div class="hero-content">
        <p>Combining <span class="destaque">STRENGTH</span>, <span class="destaque">STRATEGY</span> and <span class="destaque">PASSION </span> for gaming since 2019</p>
      </div>
    </section>

    <!-- Se√ß√£o de Top Builds -->
    <section id="top-builds">
      <h2>üèÜ Top Rated Builds</h2>
      <div class="top-builds-container" id="topBuildsContainer">
        <div class="builds-loading">Loading top builds...</div>
      </div>
    </section>

    <section id="noticias">
      <h2>News</h2>
      <div class="noticias-colunas">
        <!-- As not√≠cias ser√£o carregadas automaticamente aqui pelo JavaScript -->
        <div class="loading-noticias">
          <p style="text-align: center; color: #ffad00; padding: 40px;">
            üì∞ Carregando not√≠cias...
          </p>
        </div>
      </div>
    </section>

    <!-- NOVA SE√á√ÉO DE V√çDEOS -->
    <section id="videos">
      <h2>Best weekly plays</h2>
      <div class="video-container">
        <div class="video-wrapper">
          <!-- V√≠deo 1 -->
          <div class="video-item active" data-video="1">
            <video muted loop>
              <source src="./videos/jogada1.mp4" type="video/mp4">
              Seu navegador n√£o suporta v√≠deos HTML5.
            </video>
            <div class="video-controls">
              <button class="play-pause-btn" onclick="togglePlay(this)">‚ñ∂</button>
              <div class="volume-control">
                <span>üîä</span>
                <div class="volume-slider" onclick="adjustVolume(this, event)"></div>
              </div>
            </div>
          </div>

          <!-- V√≠deo 2 -->
          <div class="video-item" data-video="2">
            <video muted loop>
              <source src="./videos/jogada2.mp4" type="video/mp4">
              Seu navegador n√£o suporta v√≠deos HTML5.
            </video>
            <div class="video-controls">
              <button class="play-pause-btn" onclick="togglePlay(this)">‚ñ∂</button>
              <div class="volume-control">
                <span>üîä</span>
                <div class="volume-slider" onclick="adjustVolume(this, event)"></div>
              </div>
            </div>
          </div>

          <!-- V√≠deo 3 -->
          <div class="video-item" data-video="3">
            <video muted loop>
              <source src="./videos/jogada3.mp4" type="video/mp4">
              Seu navegador n√£o suporta v√≠deos HTML5.
            </video>
            <div class="video-controls">
              <button class="play-pause-btn" onclick="togglePlay(this)">‚ñ∂</button>
              <div class="volume-control">
                <span>üîä</span>
                <div class="volume-slider" onclick="adjustVolume(this, event)"></div>
              </div>
            </div>
          </div>
        </div>

        <!-- T√≠tulo das jogadas -->
        <div class="jogada-titulo">
          <span id="jogada-texto">Penta de pocot√≥ do <span class="jogador">DEIVID</span></span>
        </div>

        <!-- Indicadores (bolinhas) -->
        <div class="video-indicators">
          <div class="indicator active" onclick="showVideo(1)"></div>
          <div class="indicator" onclick="showVideo(2)"></div>
          <div class="indicator" onclick="showVideo(3)"></div>
        </div>
      </div>
    </section>

    <!-- SE√á√ÉO DE APOIADORES -->
    <section id="apoiadores">
      <h2>Partners</h2>
      <div class="apoiadores-carousel" id="apoiadoresCarousel"></div>
      <div class="carousel-indicators" id="carouselIndicators"></div>
    </section>

    <section id="loja">
      <h2>Shop</h2>
      <section class="produtos">
        <article class="produto">
          <img src="./loja/img-shop/stick.jpg" alt="Adesivos hologr√°ficos Kiss-Cut Guarini" />
          <h3>Holographic Kiss-Cut Stickers</h3>
          <p class="preco">$ 11,00</p>
          <button type="button" class="btn-comprar" data-link="https://streamlabs.com/guarini_esports/merch/5571571">Buy</button>
        </article>
        <article class="produto">
          <img src="./loja/img-shop/garrafinha.jpg" alt="Garrafa de √°gua Guarini" />
          <h3>Stainless Steel Water Bottle</h3>
          <p class="preco">$ 30,00</p>
          <button type="button" class="btn-comprar" data-link="https://streamlabs.com/guarini_esports/merch/5023084">Buy</button>
        </article>
        <article class="produto">
          <img src="./loja/img-shop/caneca.jpg" alt="Caneca Guarini" />
          <h3>Travel Mug with Handle</h3>
          <p class="preco">$ 29,00</p>
          <button type="button" class="btn-comprar" data-link="https://streamlabs.com/guarini_esports/merch/5023087">Buy</button>
        </article>
      </section>
    </section>
  </main>

  <footer>
    <div class="footer-content">
      <!-- Bot√µes de a√ß√£o no footer -->
      <div class="footer-actions">
        <!-- Bot√£o de instalar app -->
        <button id="installBtn" class="btn-install">üì± Install App</button>
        
        <!-- Seletor de idioma customizado -->
        <div class="language-selector">
          <button class="language-btn" id="languageBtn">
            <span class="flag flag-us"></span>
            <span id="currentLang">English</span>
            <span>‚ñº</span>
          </button>
          <div class="language-dropdown" id="languageDropdown">
            <div class="language-option" data-lang="pt" data-flag="flag-br" data-name="Portugu√™s">
              <span class="flag flag-br"></span>
              <span>Portugu√™s</span>
            </div>
            <div class="language-option" data-lang="en" data-flag="flag-us" data-name="English">
              <span class="flag flag-us"></span>
              <span>English</span>
            </div>
            <div class="language-option" data-lang="ja" data-flag="flag-jp" data-name="Êó•Êú¨Ë™û">
              <span class="flag flag-jp"></span>
              <span>Êó•Êú¨Ë™û</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Informa√ß√µes do footer -->
      <div class="footer-info">
        <p>&copy; ¬© 2019 Guarin√≠ E-sport. All rights reserved.</p>
        <p><a href="https://linktr.ee/guariniesports" target="_blank">Follow us on social media!</a></p>
        <p>Created by: Lobo & Shad</p>
      </div>
    </div>
  </footer>

  <!-- Google Translate (oculto) -->
  <div id="google_translate_element" style="display: none;"></div>

  <!-- Scripts -->
  <script type="text/javascript">
    function googleTranslateElementInit() {
      new google.translate.TranslateElement(
        {pageLanguage: 'pt', includedLanguages: 'pt,en,ja'},
        'google_translate_element'
      );
    }
  </script>
  <script type="text/javascript" src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>

<!-- Firebase e Autentica√ß√£o -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-app.js";
    import { 
      getAuth, 
      onAuthStateChanged, 
      signOut 
    } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-auth.js";
    import { 
      getFirestore, 
      doc, 
      getDoc,
      collection, 
      query, 
      where, 
      getDocs 
    } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyC9LLCXrQTHBagQxaChBazSfS5E4gUPIoI",
      authDomain: "site-grn.firebaseapp.com",
      projectId: "site-grn",
      storageBucket: "site-grn.firebasestorage.app",
      messagingSenderId: "27613322806",
      appId: "1:27613322806:web:ad4dc08ce043f19d530297",
      measurementId: "G-84NHN394WF"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore();

    // ========================================
    // TOP BUILDS SYSTEM
    // ========================================

    // Fun√ß√£o para capitalizar primeira letra
    function capitalizeFirst(str) {
      if (!str) return '';
      return str.charAt(0).toUpperCase() + str.slice(1);
    }

    // Processar skills do Firebase
    function processSkillsFromFirebase(selectedSkills) {
      if (!selectedSkills) return { skill1: null, skill2: null };
      
      const result = {};
      
      if (selectedSkills.s1 && selectedSkills.s1 !== 'none') {
        result.skill1 = {
          key: selectedSkills.s1,
          name: `Skill ${selectedSkills.s1.replace('s', '')}`
        };
      } else {
        result.skill1 = null;
      }
      
      if (selectedSkills.s2 && selectedSkills.s2 !== 'none') {
        result.skill2 = {
          key: selectedSkills.s2,
          name: `Skill ${selectedSkills.s2.replace('s', '')}`
        };
      } else {
        result.skill2 = null;
      }
      
      return result;
    }

    // Processar emblems do Firebase
    function processEmblemsFromFirebase(selectedEmblems) {
      if (!selectedEmblems) return { emblem1: null, emblem2: null, emblem3: null, emblem4: null };
      
      const result = {};
      const colors = ['brown', 'red', 'white', 'black', 'blue', 'yellow', 'green', 'purple', 'pink', 'gray', 'navy'];
      
      const emblems = [];
      colors.forEach(color => {
        if (selectedEmblems[color] && selectedEmblems[color] !== 'none' && selectedEmblems[color] !== '0') {
          emblems.push({
            color: color,
            level: parseInt(selectedEmblems[color]) || 0
          });
        }
      });
      
      result.emblem1 = emblems[0] || null;
      result.emblem2 = emblems[1] || null;
      result.emblem3 = emblems[2] || null;
      result.emblem4 = emblems[3] || null;
      
      return result;
    }

// Criar card de top build
function createTopBuildCard(build, rank, creatorData) {
  const pokemonImage = build.pokemon ? 
    `./estatisticas-shad/images/backgrounds/${build.pokemon}-left-bg.png` : 
    './estatisticas-shad/images/backgrounds/placeholder.png';
  
  const pokemonName = capitalizeFirst(build.pokemon);
  
  // Rating
  const totalVotes = build.ratings?.totalVotes || 0;
  const average = build.ratings?.average || 0;
  
  // Avatar do criador
  const creatorAvatar = creatorData.avatar || './estatisticas-shad/images/backgrounds/pikachu-left-bg.png';
  
  // Battle Item
  const battleItemHTML = build.battleItem ? `
    <div class="top-build-item-circle">
      <img src="./estatisticas-shad/images/battle-items/${build.battleItem}.png" 
           alt="Battle Item"
           onerror="this.style.display='none'">
    </div>
  ` : '';
  
  // Held Items
  const heldItemsHTML = build.heldItems && build.heldItems.length > 0 ? 
    build.heldItems.slice(0, 3).map(item => `
      <div class="top-build-item-circle">
        <img src="./estatisticas-shad/images/held-itens/${item.key}.png" 
             alt="${item.name}"
             title="${item.name}"
             onerror="this.style.display='none'">
      </div>
    `).join('') : '';
  
  // Skills
  const processedSkills = processSkillsFromFirebase(build.selectedSkills);
  const skillsHTML = [];
  
  for (let i = 1; i <= 2; i++) {
    const skill = processedSkills[`skill${i}`];
    
    if (skill && skill.key) {
      const skillImagePath = `./estatisticas-shad/images/skills/${build.pokemon}_${skill.key}.png`;
      skillsHTML.push(`
        <div class="top-build-skill-circle" title="${skill.name}">
          <img src="${skillImagePath}" 
               alt="${skill.name}"
               onerror="this.parentElement.classList.add('empty'); this.style.display='none'">
        </div>
      `);
    } else {
      skillsHTML.push(`
        <div class="top-build-skill-circle empty"></div>
      `);
    }
  }
  
  // Emblems
  const processedEmblems = processEmblemsFromFirebase(build.selectedEmblems);
  const emblemsHTML = [];
  
  for (let i = 1; i <= 4; i++) {
    const emblem = processedEmblems[`emblem${i}`];
    
    if (emblem && emblem.color) {
      const level = emblem.level || 0;
      emblemsHTML.push(`
        <div class="top-build-emblem-item">
          <div class="top-build-emblem-color">
            <img src="./estatisticas-shad/images/icons/${emblem.color}.png" 
                 alt="${emblem.color}"
                 style="width: 100%; height: 100%; object-fit: cover; border-radius: 50%;"
                 onerror="this.style.display='none'">
          </div>
          <div class="top-build-emblem-level">Lv.${level}</div>
        </div>
      `);
    } else {
      emblemsHTML.push(`
        <div class="top-build-emblem-item">
          <div class="top-build-emblem-color empty"></div>
          <div class="top-build-emblem-level empty">-</div>
        </div>
      `);
    }
  }
  
  // Rank badge
  const rankClass = `rank-${rank}`;
  const rankEmoji = `#${rank}`;
  
  return `
    <div class="top-build-card">
      <div class="build-rank-badge ${rankClass}">
        ${rankEmoji}
      </div>
      
      <div class="top-build-pokemon-image">
        <img src="${pokemonImage}" 
             alt="${pokemonName}"
             onerror="this.src='./estatisticas-shad/images/backgrounds/placeholder.png'">
        <div class="top-build-rating">
          <span class="top-build-rating-number">${average.toFixed(1)}</span>
          <span class="top-build-rating-stars">‚≠ê</span>
          <span class="top-build-rating-votes">(${totalVotes})</span>
        </div>
      </div>
      
      <div class="top-build-content">
        <h3 class="top-build-pokemon-name">${pokemonName}</h3>
        <p class="top-build-name">${build.buildName || 'Unnamed Build'}</p>
        
        <div class="top-build-items-section">
          ${battleItemHTML}
          <div class="top-build-held-items">
            ${heldItemsHTML}
          </div>
        </div>
        
        <div class="top-build-skills-section">
          ${skillsHTML.join('')}
        </div>
        
        <div class="top-build-emblems-section">
          ${emblemsHTML.join('')}
        </div>
        
        <div class="top-build-creator">
          <p class="top-build-creator-label">Created by:</p>
          <a href="./perfil/perfil-view.html?uid=${build.userId}" class="top-build-creator-info">
            <img src="${creatorAvatar}" 
                 alt="${creatorData.displayName}" 
                 class="top-build-creator-avatar"
                 onerror="this.src='./estatisticas-shad/images/backgrounds/pikachu-left-bg.png'">
            <div class="top-build-creator-details">
              <span class="top-build-creator-name">${creatorData.displayName || 'Anonymous'}</span>
              <span class="top-build-creator-id">ID: ${creatorData.playerId || 'N/A'}</span>
            </div>
          </a>
        </div>
      </div>
    </div>
  `;
}

    // Carregar top builds
    async function loadTopBuilds() {
      try {
        console.log('üèÜ Carregando top builds...');
        
        const topBuildsContainer = document.getElementById('topBuildsContainer');
        
        if (!topBuildsContainer) {
          console.error('‚ùå Container n√£o encontrado');
          return;
        }
        
        topBuildsContainer.innerHTML = '<div class="builds-loading">Loading top builds...</div>';
        
        // Buscar todos os usu√°rios
        const usuariosRef = collection(db, "usuarios");
        const usuariosSnap = await getDocs(usuariosRef);
        
        console.log('üì¶ Usu√°rios encontrados:', usuariosSnap.size);
        
        const allBuilds = [];
        
        // Para cada usu√°rio, buscar suas builds
        for (const userDoc of usuariosSnap.docs) {
          const userId = userDoc.id;
          const userData = userDoc.data();
          
          const buildsRef = collection(db, "usuarios", userId, "builds");
          const buildsSnap = await getDocs(buildsRef);
          
          buildsSnap.forEach(buildDoc => {
            const buildData = buildDoc.data();
            
            // S√≥ incluir builds com avalia√ß√µes
            if (buildData.ratings && buildData.ratings.totalVotes > 0) {
              allBuilds.push({
                id: buildDoc.id,
                userId: userId,
                ...buildData,
                creatorData: {
                  displayName: userData.displayName,
                  playerId: userData.playerId,
                  avatar: userData.avatar  // ‚Üê ADICIONAR ESTA LINHA
                }
              });
            }
          });
        }
        
        console.log('üìä Total de builds com votos:', allBuilds.length);
        
        if (allBuilds.length === 0) {
          topBuildsContainer.innerHTML = `
            <div class="builds-loading" style="color: #aaa;">
              No rated builds yet. Be the first to create and rate builds!
            </div>
          `;
          return;
        }
        
        // Ordenar por: 1¬∫ m√©dia, 2¬∫ total de votos
        allBuilds.sort((a, b) => {
          const avgDiff = (b.ratings?.average || 0) - (a.ratings?.average || 0);
          if (Math.abs(avgDiff) > 0.01) return avgDiff;
          return (b.ratings?.totalVotes || 0) - (a.ratings?.totalVotes || 0);
        });
        
        // Pegar top 5
        const topBuilds = allBuilds.slice(0, 5);
        
        console.log('üèÜ Top 5 builds:', topBuilds.map(b => ({
          pokemon: b.pokemon,
          avg: b.ratings.average,
          votes: b.ratings.totalVotes
        })));
        
        // Renderizar
        topBuildsContainer.innerHTML = topBuilds.map((build, index) => 
          createTopBuildCard(build, index + 1, build.creatorData)
        ).join('');
        
        console.log('‚úÖ Top builds carregadas com sucesso!');
        
      } catch (error) {
        console.error('‚ùå Erro ao carregar top builds:', error);
        const topBuildsContainer = document.getElementById('topBuildsContainer');
        if (topBuildsContainer) {
          topBuildsContainer.innerHTML = `
            <div class="builds-loading" style="color: #ff6b6b;">
              ‚ùå Error loading builds
            </div>
          `;
        }
      }
    }

    // Carregar top builds ao iniciar
    loadTopBuilds();

    // ========================================
    // ELEMENTOS DO DOM - MENU USU√ÅRIO
    // ========================================
    const userMenuToggle = document.getElementById('userMenuToggle');
    const userDropdown = document.getElementById('userDropdown');
    const userDropdownHeader = document.getElementById('userDropdownHeader');
    const authLink = document.getElementById('authLink');
    const perfilLink = document.getElementById('perfilLink');

    // ========================================
    // ELEMENTOS DO DOM - BUSCA DE PERFIL
    // ========================================
    const profileSearchBtn = document.getElementById('profileSearchBtn');
    const profileSearchInput = document.getElementById('profileSearchInput');
    const profileSearchResults = document.getElementById('profileSearchResults');

    // ========================================
    // MENU DROPDOWN DO USU√ÅRIO
    // ========================================
    
    // Toggle do menu dropdown
    userMenuToggle.addEventListener('click', function(e) {
      e.stopPropagation();
      this.classList.toggle('active');
      userDropdown.classList.toggle('show');
    });

    // Fechar dropdown ao clicar fora
    document.addEventListener('click', function(e) {
      if (!userMenuToggle.contains(e.target) && !userDropdown.contains(e.target)) {
        userMenuToggle.classList.remove('active');
        userDropdown.classList.remove('show');
      }
    });

    // Fechar dropdown ao clicar em um link
    userDropdown.querySelectorAll('a').forEach(link => {
      link.addEventListener('click', function() {
        userMenuToggle.classList.remove('active');
        userDropdown.classList.remove('show');
      });
    });
    // ========================================
    // BUSCA DE PERFIL - COM BUSCA AUTOM√ÅTICA
    // ========================================

    // Fun√ß√£o para buscar perfil
    async function buscarPerfil() {
      const playerId = profileSearchInput.value.trim().toUpperCase();
      
      if (!playerId) {
        profileSearchResults.classList.remove('show');
        return;
      }
      
      if (playerId.length < 5 || playerId.length > 7) {
        // N√£o mostrar nada se n√£o tiver 7 caracteres
        profileSearchResults.classList.remove('show');
        return;
      }
      
      try {
        // Mostrar loading
        profileSearchResults.innerHTML = '<div class="profile-search-no-results">üîç Searching...</div>';
        profileSearchResults.classList.add('show');
        
        console.log('üîç Buscando Player ID:', playerId);
        
        // Buscar usu√°rio com esse Player ID
        const usuariosRef = collection(db, "usuarios");
        const q = query(usuariosRef, where("playerId", "==", playerId));
        
        console.log('üì° Query criada, executando busca...');
        
        const querySnapshot = await getDocs(q);
        
        console.log('üì¶ Resultado da busca:', {
          empty: querySnapshot.empty,
          size: querySnapshot.size
        });
        
        if (querySnapshot.empty) {
          console.log('‚ùå Nenhum usu√°rio encontrado com Player ID:', playerId);
          profileSearchResults.innerHTML = '<div class="profile-search-no-results">‚ùå Player not found</div>';
          return;
        }
        
        // Pegar o primeiro resultado (Player ID √© √∫nico)
        const userDoc = querySnapshot.docs[0];
        const userData = userDoc.data();
        const userId = userDoc.id;
        
        console.log('‚úÖ Usu√°rio encontrado:', {
          userId: userId,
          playerId: userData.playerId,
          displayName: userData.displayName,
          email: userData.email
        });
        
        // Mostrar resultado encontrado
        profileSearchResults.innerHTML = `
          <div class="profile-search-result-item" style="background: rgba(255, 173, 0, 0.1); cursor: default;">
            <div style="flex: 1;">
              <div style="color: #ffad00; font-weight: bold; margin-bottom: 5px;">
                ‚úÖ Player found!
              </div>
              <div style="color: #fff; font-size: 13px;">
                ${userData.displayName || 'Anonymous'}
              </div>
              <div style="color: #aaa; font-size: 11px; margin-top: 3px;">
                ID: ${userData.playerId}
              </div>
            </div>
          </div>
          <div style="margin-top: 10px; text-align: center;">
            <button 
              onclick="window.location.href='./perfil/perfil-view.html?uid=${userId}'" 
              style="background: linear-gradient(45deg, #ff7500, #ffad00); border: none; padding: 10px 20px; border-radius: 8px; color: #000; font-weight: bold; cursor: pointer; transition: all 0.3s ease;"
              onmouseover="this.style.transform='scale(1.05)'; this.style.boxShadow='0 5px 15px rgba(255, 173, 0, 0.5)'"
              onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='none'"
            >
              üë§ View Profile
            </button>
          </div>
        `;
        
      } catch (error) {
        console.error('‚ùå Erro ao buscar perfil:', error);
        console.error('Detalhes do erro:', {
          message: error.message,
          code: error.code,
          stack: error.stack
        });
        
        profileSearchResults.innerHTML = `
          <div class="profile-search-no-results" style="color: #ff6b6b;">
            ‚ùå Search error<br>
            <small style="font-size: 11px; color: #aaa; margin-top: 5px; display: block;">
              ${error.message}
            </small>
          </div>
        `;
      }
    }

    // Toggle da barra de busca
    profileSearchBtn.addEventListener('click', (e) => {
      e.stopPropagation();
      console.log('üñ±Ô∏è Bot√£o de busca clicado');
      profileSearchInput.classList.toggle('active');
      
      if (profileSearchInput.classList.contains('active')) {
        console.log('‚úÖ Input ativado');
        profileSearchInput.focus();
      } else {
        console.log('‚ùå Input desativado');
        profileSearchInput.value = '';
        profileSearchResults.classList.remove('show');
      }
    });

    // Buscar ao pressionar Enter (mantido para compatibilidade)
    profileSearchInput.addEventListener('keypress', async (e) => {
      if (e.key === 'Enter') {
        console.log('‚å®Ô∏è Enter pressionado');
        await buscarPerfil();
      }
    });

    // Valida√ß√£o do input e BUSCA AUTOM√ÅTICA ao digitar 7 caracteres
    profileSearchInput.addEventListener('input', async (e) => {
      // Valida√ß√£o: apenas alfanum√©rico, m√°ximo 7 caracteres
      e.target.value = e.target.value.toUpperCase().replace(/[^A-Z0-9]/g, '');
      if (e.target.value.length > 7) {
        e.target.value = e.target.value.slice(0, 7);
      }
      
      // üî• BUSCA AUTOM√ÅTICA quando atingir 7 caracteres
      if (e.target.value.length >= 5 && e.target.value.length <= 7) { 
        console.log('üéØ 7 caracteres digitados - buscando automaticamente...');
        await buscarPerfil();
      } else {
        // Se tiver menos de 7 caracteres, esconder resultados
        profileSearchResults.classList.remove('show');
      }
    });

    // Fechar ao clicar fora
    document.addEventListener('click', (e) => {
      if (!e.target.closest('.profile-search-container')) {
        profileSearchInput.classList.remove('active');
        profileSearchResults.classList.remove('show');
      }
    });

    // ========================================
    // AUTENTICA√á√ÉO DO USU√ÅRIO
    // ========================================
    
    // Fun√ß√£o para atualizar a interface com base no estado do usu√°rio
    async function updateUI(user) {
      if (user) {
        try {
          // Buscar dados do Firestore
          const userDocRef = doc(db, "usuarios", user.uid);
          const userDocSnap = await getDoc(userDocRef);
          
          let displayName = user.displayName || user.email.split('@')[0];
          let avatarPath = './estatisticas-shad/images/backgrounds/pikachu-left-bg.png';
          
          // Se existe documento no Firestore, usar os dados de l√°
          if (userDocSnap.exists()) {
            const userData = userDocSnap.data();
            if (userData.displayName) {
              displayName = userData.displayName;
            }
            if (userData.avatar) {
              avatarPath = userData.avatar;
            }
          }
          
          // Atualizar interface
          userDropdownHeader.innerHTML = `
            <img src="${avatarPath}" alt="Avatar" class="dropdown-avatar">
            <span>Ol√°, ${displayName}!</span>
          `;
          authLink.textContent = 'Logout';
          authLink.onclick = function(e) {
            e.preventDefault();
            handleLogout();
          };
          perfilLink.style.display = 'block';
          
          console.log('‚úÖ Usu√°rio logado:', user.email);
          
        } catch (error) {
          console.error('‚ùå Erro ao carregar dados do usu√°rio:', error);
          // Fallback em caso de erro
          userDropdownHeader.innerHTML = `
            <img src="./estatisticas-shad/images/backgrounds/pikachu-left-bg.png" alt="Avatar" class="dropdown-avatar">
            <span>Ol√°, ${user.email.split('@')[0]}!</span>
          `;
          authLink.textContent = 'Logout';
          authLink.onclick = function(e) {
            e.preventDefault();
            handleLogout();
          };
          perfilLink.style.display = 'block';
        }
      } else {
        // Usu√°rio n√£o est√° logado
        userDropdownHeader.innerHTML = '<span>Ol√°, visitante!</span>';
        authLink.textContent = 'Login';
        authLink.onclick = function(e) {
          e.preventDefault();
          handleLogin();
        };
        perfilLink.style.display = 'none';
        
        console.log('Usu√°rio n√£o logado');
      }
    }

    // Fun√ß√£o para fazer login
    function handleLogin() {
      window.location.href = '/login/login.html';
    }

    // Fun√ß√£o para fazer logout
    async function handleLogout() {
      const confirmar = confirm('Deseja realmente fazer logout?');
      if (confirmar) {
        try {
          // üî• LIMPAR DADOS DO LOCALSTORAGE
          localStorage.removeItem('userDisplayName');
          localStorage.removeItem('userAvatar');
          
          await signOut(auth);
          alert('Logout realizado com sucesso!');
          // A interface ser√° atualizada automaticamente pelo onAuthStateChanged
        } catch (error) {
          console.error('Erro no logout:', error);
          alert('Erro ao fazer logout. Tente novamente.');
        }
      }
    }

    // Monitorar mudan√ßas no estado de autentica√ß√£o
    onAuthStateChanged(auth, (user) => {
      updateUI(user);
    });
  </script>

  <!-- Scripts principais -->
<script src="./videos/videos.js"></script>
<script type="module" src="./noticias/noticias-index.js"></script>
<script type="module" src="./noticias/botao-editor.js"></script>

   <script>
    // ====================================
    // SISTEMA DE APOIADORES - CONFIGURA√á√ÉO
    // ====================================

    // Array com os dados dos apoiadores
      const apoiadores = [
    {
      nome: "Mineira sem Freio",
      descricao: "Canal com novidades sobre Pokemon Unite",
      logo: "./img-site/apoiadores/jessiemineira.jpg",
      redes: [
        {
          tipo: "youtube",
          url: "https://www.youtube.com/@jessiemineira",
          icone: "./img-site/youtube-icon.png"
        },
        {
          tipo: "X",
          url: "https://x.com/jessie_mineira",
          icone: "./img-site/x-icon.png"
        },
        {
          tipo: "twitch",
          url: "https://www.twitch.tv/jessie_mineira",
          icone: "./img-site/twitch-icon.png"
        }
      ]
    },
    {
      nome: "Leandro Decidueye",
      descricao: "Canal no Youtube com gameplays e novidades",
      logo: "./img-site/apoiadores/leandrodecidueye.jpg",
      redes: [
        {
          tipo: "youtube",
          url: "https://www.youtube.com/@leandrodecidueye5045",
          icone: "./img-site/youtube-icon.png"
        },
        {
          tipo: "twitch",
          url: "https://www.twitch.tv/leandrodecidueye",
          icone: "./img-site/twitch-icon.png"
        },
        {
          tipo: "discord",
          url: "https://discord.gg/ubxkRNGFn2",
          icone: "./img-site/discord-icon.png"
        }
      ]
    },
    {
      nome: "Doixka",
      descricao: "Stream com gameplay de v√°rios jogos",
      logo: "./img-site/apoiadores/doixka.jpg",
      redes: [
        {
          tipo: "twitch",
          url: "https://www.twitch.tv/doixka",
          icone: "./img-site/twitch-icon.png"
        },
        {
          tipo: "tiktok",
          url: "https://www.tiktok.com/@rayssadoixkaoliveira",
          icone: "./img-site/tiktok-icon.png"
        },
        {
          tipo: "youtube",
          url: "https://www.youtube.com/@RKKOliveira",
          icone: "./img-site/youtube-icon.png"
        }
      ]
    },
    {
      nome: "QBPudds",
      descricao: "Narrador e criador de conte√∫do para Pokemon Unite",
      logo: "./img-site/apoiadores/qbpudds.png",
      redes: [
        {
          tipo: "twitch",
          url: "https://www.twitch.tv/qbpudds",
          icone: "./img-site/twitch-icon.png"
        },
        {
          tipo: "X",
          url: "https://x.com/QBPudds",
          icone: "./img-site/x-icon.png"
        },
        {
          tipo: "youtube",
          url: "https://www.youtube.com/@QBPudds",
          icone: "./img-site/youtube-icon.png"
        }
      ]
    },
    {
      nome: "Shad",
      descricao: "Desenvolvedor e Coach de Pokemon Unite",
      logo: "./img-site/apoiadores/shad.jpg",
      redes: [
        {
          tipo: "twitch",
          url: "https://www.twitch.tv/geoshad",
          icone: "./img-site/twitch-icon.png"
        },
        {
          tipo: "X",
          url: "https://x.com/Shadtrader32",
          icone: "./img-site/x-icon.png"
        },
        {
          tipo: "reddit",
          url: "https://www.reddit.com/user/FoundationDry9683/",
          icone: "./img-site/reddit-icon.png"
        }
      ]
    },
    {
      nome: "Lobo",
      descricao: "Software Engineer and GameDev",
      logo: "./img-site/apoiadores/lobo.png",
      redes: [
        {
          tipo: "X",
          url: "https://x.com/lobo_vgc",
          icone: "./img-site/x-icon.png"
        },
        {
          tipo: "twitch",
          url: "https://www.twitch.tv/lobo_vgc",
          icone: "./img-site/twitch-icon.png"
        },
        {
          tipo: "tiktok",
          url: "https://www.tiktok.com/@lobo_vgc",
          icone: "./img-site/tiktok-icon.png"
        }
      ]
    }
  ];

    // ====================================
    // L√ìGICA DO CARROSSEL
    // ====================================

    let currentIndex = 0;
    const cardsVisible = 3; // Quantidade de cards vis√≠veis
    const rotationInterval = 5000; // Tempo em ms (5 segundos)
    let autoRotate;

    const carouselContainer = document.getElementById('apoiadoresCarousel');
    const indicatorsContainer = document.getElementById('carouselIndicators');

    // Fun√ß√£o para criar um card de apoiador com m√∫ltiplas redes sociais
    function createApoiadorCard(apoiador) {
      const card = document.createElement('div');
      card.className = 'apoiador-card';
      
      // Criar HTML dos bot√µes de redes sociais
      const redesHTML = apoiador.redes.map(rede => `
        <a href="${rede.url}" 
          target="_blank" 
          class="apoiador-social-btn ${rede.tipo}"
          title="${rede.tipo.charAt(0).toUpperCase() + rede.tipo.slice(1)}"
          aria-label="${rede.tipo}">
          <img src="${rede.icone}" 
              alt="${rede.tipo}" 
              onerror="this.src='https://via.placeholder.com/28/ffad00/000000?text=${rede.tipo.charAt(0).toUpperCase()}'">
        </a>
      `).join('');
      
      card.innerHTML = `
        <img src="${apoiador.logo}" alt="${apoiador.nome}" class="apoiador-logo">
        <h3 class="apoiador-nome">${apoiador.nome}</h3>
        <p class="apoiador-descricao">${apoiador.descricao}</p>
        <div class="apoiador-social-links">
          ${redesHTML}
        </div>
      `;
      return card;
    }

    // Fun√ß√£o para renderizar os cards vis√≠veis
    function renderCards(addSlideAnimation = false) {
      carouselContainer.innerHTML = '';
      
      for (let i = 0; i < cardsVisible; i++) {
        const index = (currentIndex + i) % apoiadores.length;
        const card = createApoiadorCard(apoiadores[index]);
        
        // Adicionar anima√ß√£o de deslizar para os cards que j√° estavam vis√≠veis
        if (addSlideAnimation && i < cardsVisible - 1) {
          card.classList.add('deslizando');
        }
        
        // Adicionar anima√ß√£o de entrada para o novo card
        if (i === cardsVisible - 1) {
          card.classList.add('entrando');
        }
        
        carouselContainer.appendChild(card);
      }
      
      updateIndicators();
    }

    // Fun√ß√£o para criar indicadores
    function createIndicators() {
      indicatorsContainer.innerHTML = '';
      
      apoiadores.forEach((_, index) => {
        const indicator = document.createElement('div');
        indicator.className = 'indicator';
        if (index === currentIndex) {
          indicator.classList.add('active');
        }
        
        indicator.addEventListener('click', () => {
          currentIndex = index;
          renderCards();
          resetAutoRotate();
        });
        
        indicatorsContainer.appendChild(indicator);
      });
    }

    // Fun√ß√£o para atualizar indicadores
    function updateIndicators() {
      const indicators = indicatorsContainer.querySelectorAll('.indicator');
      indicators.forEach((indicator, index) => {
        if (index === currentIndex) {
          indicator.classList.add('active');
        } else {
          indicator.classList.remove('active');
        }
      });
    }

    // Fun√ß√£o para rotacionar os cards
    function rotateCards() {
      const cards = carouselContainer.querySelectorAll('.apoiador-card');
      
      // Adicionar anima√ß√£o de sa√≠da ao primeiro card
      if (cards[0]) {
        cards[0].classList.add('saindo');
      }
      
      // Aguardar a anima√ß√£o e ent√£o atualizar
      setTimeout(() => {
        currentIndex = (currentIndex + 1) % apoiadores.length;
        renderCards();
      }, 400);
    }

    // Fun√ß√£o para resetar o auto-rotate
    function resetAutoRotate() {
      clearInterval(autoRotate);
      autoRotate = setInterval(rotateCards, rotationInterval);
    }

    // Inicializar o carrossel
    function initCarousel() {
      createIndicators();
      renderCards();
      autoRotate = setInterval(rotateCards, rotationInterval);
    }

    // Pausar rota√ß√£o ao passar o mouse
    carouselContainer.addEventListener('mouseenter', () => {
      clearInterval(autoRotate);
    });

    // Retomar rota√ß√£o ao sair com o mouse
    carouselContainer.addEventListener('mouseleave', () => {
      resetAutoRotate();
    });

    // Iniciar o carrossel quando a p√°gina carregar
    window.addEventListener('DOMContentLoaded', initCarousel);
  </script>

  <script>
    // Funcionalidade dos bot√µes de compra
    const botoes = document.querySelectorAll(".btn-comprar");
    botoes.forEach((botao) => {
      botao.addEventListener("click", () => {
        const link = botao.getAttribute("data-link");
        if (link) {
          window.open(link, "_blank");
        }
      });
    });

    // PWA - Service Worker
    if ("serviceWorker" in navigator) {
      navigator.serviceWorker
        .register("/service-worker.js")
        .then(() => console.log("Service Worker registrado!"))
        .catch((err) => console.error("Erro no Service Worker:", err));
    }

    // PWA - Bot√£o de instala√ß√£o
    let deferredPrompt;

    window.addEventListener('beforeinstallprompt', (e) => {
      e.preventDefault();
      deferredPrompt = e;
      document.getElementById('installBtn').style.display = 'block';
    });

    document.getElementById('installBtn').addEventListener('click', async () => {
      if (!deferredPrompt) return;
      deferredPrompt.prompt();
      const { outcome } = await deferredPrompt.userChoice;
      deferredPrompt = null;
      document.getElementById('installBtn').style.display = 'none';
      console.log('Usu√°rio respondeu:', outcome);
    });

    // Seletor de idioma customizado
    const languageBtn = document.getElementById('languageBtn');
    const languageDropdown = document.getElementById('languageDropdown');
    const currentLang = document.getElementById('currentLang');
    const languageOptions = document.querySelectorAll('.language-option');

    // Toggle dropdown
    languageBtn.addEventListener('click', function(e) {
      e.stopPropagation();
      languageDropdown.classList.toggle('show');
    });

    // Fechar dropdown ao clicar fora
    document.addEventListener('click', function(e) {
      if (!languageBtn.contains(e.target)) {
        languageDropdown.classList.remove('show');
      }
    });

    // Selecionar idioma
    languageOptions.forEach(option => {
      option.addEventListener('click', function() {
        const lang = this.dataset.lang;
        const flag = this.dataset.flag;
        const name = this.dataset.name;
        
        // Atualizar interface do bot√£o
        const flagElement = languageBtn.querySelector('.flag');
        flagElement.className = `flag ${flag}`;
        currentLang.textContent = name;
        
        // Fechar dropdown
        languageDropdown.classList.remove('show');
        
        // Usar Google Translate
        const translateElement = document.querySelector('.goog-te-combo');
        if (translateElement) {
          translateElement.value = lang;
          translateElement.dispatchEvent(new Event('change'));
        } else {
          // Se o Google Translate n√£o estiver carregado ainda, aguardar
          setTimeout(() => {
            const translateElement = document.querySelector('.goog-te-combo');
            if (translateElement) {
              translateElement.value = lang;
              translateElement.dispatchEvent(new Event('change'));
            }
          }, 1000);
        }
      });
    });
  </script>
  <script>
  // Mover bot√£o de busca para dentro do header no mobile
  function adjustSearchButtonPosition() {
    const searchContainer = document.querySelector('.profile-search-container');
    const header = document.querySelector('header');
    const body = document.body;
    
    if (window.innerWidth <= 768) {
      // Mobile: mover para dentro do header
      if (searchContainer && header && searchContainer.parentElement !== header) {
        header.appendChild(searchContainer);
      }
    } else {
      // Desktop: manter no body
      if (searchContainer && body && searchContainer.parentElement !== body) {
        body.appendChild(searchContainer);
      }
    }
  }
  
  // Executar ao carregar e ao redimensionar
  adjustSearchButtonPosition();
  window.addEventListener('resize', adjustSearchButtonPosition);
</script>

</body>
</html>